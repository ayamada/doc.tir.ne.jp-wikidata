---
toc: yes
...

このdoc.tir.ne.jpは、[gitit]を使って構築しています。

このページでは、その[gitit]のノウハウやメモを書いていきます。

[gitit]: http://gitit.net/


# doc.tir.ne.jp 固有の情報

- 今入っているgititのバージョンは、 gitit version 0.10.0.1 +plugins

続きはあとで


# 一般的な情報

- gititで利用できるmarkdown書式は通常のものよりも拡張された [Pandoc's markdown](http://johnmacfarlane.net/pandoc/README.html#pandocs-markdown) との事。

続きはあとで


# その他のメモ

- gititの読み方は「ぎちっと」でいいのか？


# TODO

TODOが完了したら、[#完了したTODO]()に移動させるか、上の各項目のどれかに反映するか、ちゃんと処理する事。

- 可能なら自分で新たに「\$hoge\$」タグを追加して、docとintraのテンプレートを完全に共通化させたいので、可能かどうか調べる
    - とりあえず、class="public-only" class="intra-only"を用意して、cssレベルで区別だけしては？
        - css自体も共通にしたいので、もうちょっと考える必要はあるが…
    - 他にも変数で変更したい部分はあるので調査自体は行う。面倒ならもう「\$if(feed)\$」等の他の用途の変数を流用する事を考える
    - これはpandocのtemplate機能らしい→ http://johnmacfarlane.net/pandoc/README.html#templates
- ExportのSlidyを動くようにする。それができないなら「\$exportbox\$」から抜く方法を考える
- 新規ページ作成時に、最初から「\<!-- vim:set ft=markdown: --\>」のコメントが入っている状態になるようにしたい(初期ドキュメントテンプレ機能)
    - 他にもtoc等、デフォルトで入ってるとよさそうな設定があるなら入れたいので優先度高
- hoge.st内における、httpからはじまるfull urlの出し方を調べ、pagetool.stのbingのところに反映
    - 調べた結果、取れるインターフェースはないようだ…
        - デフォルトではhostnameシステムコールで取るらしい
        - どうしても取りたいなら自分でプラグイン作ってHost: ヘッダから取るしかなさそう
- 編集サイトのみ、左サイドバー内のどこかに、「公開サイトと編集サイトの違い」「同期方法」「うっかり編集サイトのURLを外に貼らないよう注意！」等々の説明書きをする事を考える
- gitit.confで use-cache: yes にしたところ、リポジトリ同期による内容更新ではキャッシュが更新されなかった。これでは公開側で利用できないので対策を考える。
    - 手動リポジトリ同期時にcacheディレクトリを捨てる？
    - mod_proxyによるキャッシング
        - gititはLast-Modifiedとかは出してないので、有効でない気がする…
    - 調べたら、一緒にインストールされている「expireGititCache」がまさにその用途のものだった。これを使うようにする
- 日本語のmarkdown記法の解説ページ(可能ならpandoc版のもの)へのリンクを左サイドバーに追加する
- ページ編集時に「＆******；」や「＆＃nn；」を記入した時の処理がおかしい件をもうちょっと調べる→調べた
    - 例えば、ページ編集時に「＆ａｍｐ；」と書いて保存して、再度編集しようとして編集画面を開くと、さっき書いた「＆ａｍｐ；」が「＆」へと実体にされてしまっている。実際のストレージ内でも同じ状態になってしまっている
    - 例えば、ページ編集時に「＆ａｍｐ；ａｍｐ；」と書いてプレビューしてみると、「＆ａｍｐ；」ではなく「＆」と表示されてしまっている
    - つまり、textareaに入力されたデータがそのまま保存されるのではなく、HTMLの実体参照に対してアンエスケープがかけられた状態で保存されてしまっている
    - gititが悪いのか、どれかのモジュールが悪いのか、可能ならあとで原因を特定する事。
        - Happstackが古いのが原因のような気がするのであとでバージョンを上げてみる
- がんばってcssを独自作成する？
- サブディレクトリなwikinameのところに「..」相当のリンクをつけたい
    - gititのモジュール書いてやってみる
    - しかしどうも、gititでは「/dir」と「/dir/」の扱いが違い、「/dir/child」があるからといって「/dir」があるとは限らないので(「/dir/」はあるが)、安易に「..」相当のリンクを貼れないっぽいようだ。モジュール作らずに手で貼った方がいい？
        - しかし、doc.tir.ne.jpに限れば、「/dir/child」を書く時は「/dir」も書くルールで運用する、という事なら、モジュール作ってしまった方がいいと思う
- Recent changes とかの日時をUTCじゃなくJSTにしたい


# 完了したTODO

あとで



<!-- vim:set ft=markdown: -->
